---
layout: post
title: Struts 2 Validator on Forwards
date: '2008-09-30T12:10:00.008-04:00'
author: Alberto
tags:
- Struts2
- Validator
modified_time: '2008-10-02T09:39:42.981-04:00'
blogger_id: tag:blogger.com,1999:blog-4831432806087932521.post-5278779412984167373
blogger_orig_url: https://alberto-flores.blogspot.com/2008/08/struts-2-validator-on-forwards.html
---

<div align="justify"><br />As I had to add some complex features to our working Struts 2 application, I had to deal with already built in validator functionality in Struts2 that could be complex. Specifically, when dealing with conversations-like scenarios, this problem can really be a big one if the validation associated with the forward request is applied via annotations, xml or the validate method. I thought to share some snippets that hopefully will someone. Consider the following:<br /><br /><pre name="code" class="java"><br />package sample;<br /><br />public class MyValidatorInterceptor1 <br />     extends AnnotationValidationInterceptor {<br /> /**<br />  * Method that is triggered in prior to calling<br />  * the intercept() method. This method allows<br />  * to control whether the intercept is disabled<br />  * in certain condition.<br />  */<br /> @Override<br /> protected boolean applyInterceptor<br />            (ActionInvocation invocation) {<br />  boolean certainCondition = true<br />  if (certainCondition) {<br />    return false;<br />  }<br />  return super.applyInterceptor(invocation);<br /> }<br />}<br /></pre><br />This interceptor implementation as described above enhances the provided <code>AnnotationValidationInterceptor</code> from Struts 2 to disable the interceptor on demand (based on some condition). It's important to mention that the code above extends the class <code>AnnotationValidationInterceptor</code> as base class so as to not take away current functionality offered in Struts 2 (validation annotation). Additionally, the <code>doIntercept()</code> method may be overridable to perform additional validation that can be applied per class. Consider the scenario where you define your want to add validation complex validation per method and disable all required validations in XML. This certainly introduces many possibilities. Now, it will be worth to mention that struts.xml will need to have this as well to be useful.<br /><pre class="xml" name="code"><br /><br />&lt;struts&gt;<br />  &lt;interceptors&gt;<br />    &lt;interceptor name="dynamicValidator"<br />                    class="sample.MyValidatorInterceptor1"/&gt;<br /><br />    &lt;interceptor-stack name="myInteceptorStack"&gt;<br />      &lt;interceptor-ref name="exception"/&gt;<br />      &lt;interceptor-ref name="alias"/&gt;<br />      &lt;interceptor-ref name="params"/&gt;<br />      &lt;interceptor-ref name="servletConfig"/&gt;<br />      &lt;interceptor-ref name="prepare"/&gt;<br />      &lt;interceptor-ref name="i18n"/&gt;<br />      &lt;interceptor-ref name="chain"/&gt;<br />      &lt;interceptor-ref name="modelDriven"/&gt;<br />      &lt;interceptor-ref name="fileUpload"/&gt;<br />      &lt;interceptor-ref name="checkbox"/&gt;<br />      &lt;interceptor-ref name="staticParams"/&gt;<br />      &lt;interceptor-ref name="params"/&gt;<br />      &lt;interceptor-ref name="conversionError"/&gt;<br />      &lt;interceptor-ref name="dynamicValidator"&gt;<br />        &lt;param name="excludeMethods"&gt;<br />          input,back,cancel<br />        &lt;/param&gt;<br />      &lt;/interceptor-ref&gt;<br />      &lt;interceptor-ref name="workflow"&gt;<br />        &lt;param name="excludeMethods"&gt;<br />          input,back,cancel<br />        &lt;/param&gt;<br />      &lt;/interceptor-ref&gt;<br />    &lt;/interceptor-stack&gt;<br />  &lt;/interceptors&gt;<br /><br />  &lt;default-interceptor-ref name="myInteceptorStack"/&gt;<br />&lt;/struts&gt;<br /></pre><br />Note that the configuration now uses almost all interceptors defined in the <code>paramsPrepareParamsStack</code> except the validator one. This is one architectural part of Struts 2 which I find it very compelling. You can grab any part of the interceptors, swapped with your custom ones and provide meaningful processing according to your needs.<br /><br />Now, the validator code above deserves further explanation. Consider the case when an action forwards control (with the result type <code>redirect-action</code>). The forwarder action may not necessarily know whether the forwarded action is really validated or not, and hence the validation process will still be applied. In such case, one may need to allow some processing to decline validation on the subsequent action handling (such as placing a token on request/session/valueStack for starters).<br /><br /></div>