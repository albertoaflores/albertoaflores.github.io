---
layout: post
title: Spring 3.0 and <mvc:annotation-driven />
date: '2010-01-28T00:46:00.008-05:00'
author: Alberto
tags:
- MVC
- Spring-MVC
- Annotations
- JSR-303
- Spring
modified_time: '2010-01-30T00:32:49.682-05:00'
blogger_id: tag:blogger.com,1999:blog-4831432806087932521.post-4284141344028238653
blogger_orig_url: https://alberto-flores.blogspot.com/2010/01/spring-30-and.html
---

I have used <i>Struts1</i> and<i> Struts2</i> extensively for years.&nbsp; With that background, I can appreciate some of the things that <i>Spring-MVC</i> brings to the table such as Dependency Injection, clean integration with Bean Validator (JSR-303), smooth Integration with different View Technologies, among others. Furthermore,&nbsp; <i>Spring-MVC</i> has been making improvements through out each release that has made it a more robust framework, including the latest REST support. Like every framework, there is always a "gotcha" in a feature and such is the case for <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven></mvc:annotation-driven></span>.<br /><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven></mvc:annotation-driven></span> <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span> is a nice feature, however depending on how you are used to organize your <i>Spring-MVC</i> files, it can prove to be confusing. I'll try to explain my findings as clear as I can.<br /><a name='more'></a><br />As you know, <i>Spring-MVC</i> will expect a<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"> &lt;<servlet-name>servlet-name&gt;-servlet.xml</servlet-name></span> Spring configuration in the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">WEB-INF</span> (unless configured otherwise in <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">web.xml</span>). If you also load an application context via Spring's <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">RequestContextListener</span> (hereto known as the <i>root</i> WebApplicationContext), the servlet XML (<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">WebApplicationContext</span>) will <i>inherit</i> the beans from the <i>root</i> context.&nbsp; Although this is a known fact, the problem comes when the servlet XML is not able to read any <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">@RequestMapping</span> metadata from beans (<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">@Controller</span> objects) detected in the <i>root</i> WebApplication Context. The logs clearly show that the beans are detected, but not the metadata.<br /><br />This means that in order to use <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span> <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven></mvc:annotation-driven></span> you have two choices:<br /><ol><li> The servlet XML now needs to contain <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span> <b><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven></mvc:annotation-driven></span> and</b> be able to detect the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">@Controller</span> objects so it can refer to the metadata in those controllers to use (e.g. via <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;context:component-scan /&gt;</span> <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><context:classpath-scan>)</context:classpath-scan></span>. All these within the same XML file or via imports.<br /></li><li>The root XML needs to have the declarations as mentioned above (<span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven> </mvc:annotation-driven></span>and<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"> </span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;context:component-scan /&gt;</span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><context:classpath-scan>)</context:classpath-scan></span>.</li></ol>I prefer to use the first one, and make my <i>scan</i> reach only the packages that are specific to the design of your servlet, however I can see how option 2 may be a more compelling option for small applications. Interestingly enough, that's how all sample applications using <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span> <span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><mvc:annotation-driven></mvc:annotation-driven></span> are configured.<br /><br />For further reading of this new features, take a look at JIRA issue <a href="http://jira.springframework.org/browse/SPR-6524">SPR-6524</a> where Jurgen Hoeller and Keith Donald explain their thoughts on why <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&lt;mvc:annotation-driven /&gt;</span> is supposed to behave like this.<br /><br />Hopefully this helps some!